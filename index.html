$(document).ready(function() {
    // FlipBook Initialization
    $(".thumb").on("click", function() {
        var pdfUrl = $(this).data("pdf-url");
        if ($.fn.flipBook) {
            $(this).flipBook({
                pdfUrl: pdfUrl,
                btnColor: "#e74c3c",
                sideBtnRadius: 50,
                sideBtnSize: 50,
                sideBtnBackground: "rgba(0,0,0,.8)",
                sideBtnColor: "#e74c3c",
                lightBox: true,
                viewMode: "3d",
                layout: 3,
                btnSound: {
                    vAlign: "top",
                    hAlign: "left"
                },
                btnAutoplay: {
                    vAlign: "top",
                    hAlign: "left"
                },
                currentPage: {
                    vAlign: "bottom",
                    hAlign: "left"
                },
            });
        } else {
            console.error("flipBook plugin is not loaded.");
        }
    });

    // Filter Functionality
    function setActiveFilter(filterValue) {
        var $buttons = $(".filter-btn");
        var $thumbs = $(".thumb");
        $buttons.removeClass("active btn-primary").addClass("btn-secondary");
        $buttons.filter("[data-filter='" + filterValue + "']").addClass("active btn-primary").removeClass("btn-secondary");
        $thumbs.each(function() {
            var $thumb = $(this);
            $thumb.toggle(filterValue === "all" || $thumb.data("category") === filterValue);
        });
    }

    $(".filter-btn").on("click", function() {
        setActiveFilter($(this).data("filter"));
    });

    setActiveFilter("all");

    // Close Flipbook
    function closeFlipbook() {
        // Logic to close or hide the flipbook
        console.log("Flipbook closed");
        $('.flipbook-container').hide();
    }

    // Bind the close button to the close function
    $(document).on('click', '.btnClose', function() {
        closeFlipbook();
    });

    // Bind the ESC key to the close function
    $(document).on('keydown', function(e) {
        if (e.key === "Escape") {
            closeFlipbook();
        }
    });
});
